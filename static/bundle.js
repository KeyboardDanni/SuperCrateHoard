(()=>{"use strict";const t=1e3/60;class i{constructor(){if(this.lastTick=performance.now(),this.tickQueue=0,this.tickCount=0,this.framesSinceLastLag=0,this.doDraw=!1,this.doLerp=!1,this.canvas=document.getElementById("game_surface"),!this.canvas||!this.canvas.getContext)throw new Error("Missing canvas");if(this.context=this.canvas.getContext("2d"),!this.context)throw new Error("Could not create canvas context")}run(){this.lastTick=performance.now(),this.tickQueue=0,requestAnimationFrame(this.timerUpdate.bind(this))}timerUpdate(){this.updateTicks(),this.draw(),requestAnimationFrame(this.timerUpdate.bind(this))}updateTicks(){const i=performance.now();for(this.tickQueue+=i-this.lastTick,this.lastTick=i;this.tickQueue>=t;){this.tick(),this.framesSinceLastLag++,this.doDraw=!0,this.tickQueue-=t;const s=performance.now();if(s-i>33.333333333333336){this.tickQueue=0,this.lastTick=s,this.doLerp=!1,this.framesSinceLastLag=0;break}}this.framesSinceLastLag>=10&&(this.doLerp=!0)}tick(){this.tickCount+=1}draw(){if(!this.doDraw)return;if(!this.canvas||!this.context)throw new Error("Missing canvas");let i;this.doLerp?i=this.tickQueue/t:(i=1,this.doDraw=!1),this.context.clearRect(0,0,this.canvas.width,this.canvas.height);const s=64+this.tickCount%60*4,e=64+(this.tickCount-1)%60*4;var a,n,c;this.context.fillStyle="rgb(128, 128, 128)",this.context.fillRect((a=e,n=s,(c=i)<=0?a:c>=1?n:a+c*(n-a)),64,256,256),console.info("Draw")}}window.onload=function(){(new i).run()}})();